<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>probando2</title>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
     <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-analytics.js"></script>

     <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-storage.js"></script>
</head>
<body>
    
    <style>
        body{
            display: flex;
            min-height: 100vh;
            width: 100%;
            padding: 0;
            margin: 0;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        #uploader{
            -webkit-appearance: none;
            appearance: none;
            width: 50%;
            margin-bottom: 10px;
        }
    </style>
      <progress value="0"  max="100" id="uploader">0%</progress>
      <input type="file" name="files[]" id="files" value="upload">
  
      <button onclick="prueba()">Agregar</button>
  
  
      
      <script>
          
          
          
          // Your web app's Firebase configuration
          // For Firebase JS SDK v7.20.0 and later, measurementId is optional
          var config = {
              apiKey: "AIzaSyCwsFDdN2914nYD_9IiaEb35i_gGvTNa3U",
              authDomain: "proyectoprueba-b1664.firebaseapp.com",
              databaseURL: "https://proyectoprueba-b1664-default-rtdb.firebaseio.com",
              projectId: "proyectoprueba-b1664",
              storageBucket: "proyectoprueba-b1664.appspot.com",
              messagingSenderId: "114176212234",
              appId: "1:114176212234:web:f51d8049474581f13acef3",
              measurementId: "G-5KZNZCMVRQ"
            };
            // Initialize Firebase
            firebase.initializeApp(config);
            
            var urlImagen;
           
            var fileButton=document.getElementById('fileButton');
            function prueba(){
                // Created a Storage Reference with root dir
                
                // Get the file from DOM
                var file = document.getElementById("files").files[0];
                
                var storageRef = firebase.storage().ref("images/"+file.name);
                //dynamically set reference to the file name
                var thisRef = storageRef.put(file);
                // var urlPrueba 
                
                /*
               thisRef.snapshot.getDownloadURL().then(function (URL) {
                   console.log("la url 1 es " +URL)    
                });*/
                
                
                //put request upload file to firebase storage
                /*
                thisRef.put(file).then(function(snapshot) {
                    alert("File Uploaded")
                    console.log('Uploaded a blob or file!');
                   
                    
                });*/
                thisRef.on('state_changed', null,
                function(error){
                    console.log('Error al subir el archivo', error);
                },
                function(){
                    //recuperar el url
                     thisRef.snapshot.ref.getDownloadURL().then((URL)=> {
                   console.log("la url 1 es " +URL)    
                   return  URL ;

                });
                console.log("la url FUERA DE LA FUNCION es " +urlImagen)  
                    
                }
                );
                
                
                
                
            }
           
            </script>
        </body>
        </html>